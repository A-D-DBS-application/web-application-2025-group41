-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.MACHINE_SIZE_CALC1 (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  request_id uuid NOT NULL UNIQUE,
  recommended_machine_id integer NOT NULL,
  CONSTRAINT MACHINE_SIZE_CALC1_pkey PRIMARY KEY (id),
  CONSTRAINT machine_size_calc1_request_id_fkey FOREIGN KEY (request_id) REFERENCES public.REQUEST(id),
  CONSTRAINT machine_size_calc1_recommended_machine_id_fkey FOREIGN KEY (recommended_machine_id) REFERENCES public.MACHINE_SPECS(id)
);
CREATE TABLE public.MACHINE_SPECS (
  id integer NOT NULL DEFAULT nextval('machine_specs_id_seq'::regclass),
  size_code text NOT NULL,
  capacity integer NOT NULL CHECK (capacity > 0),
  selling_price numeric NOT NULL CHECK (selling_price >= 0::numeric),
  electricity_consumption numeric NOT NULL DEFAULT 0,
  water_consumption numeric NOT NULL DEFAULT 0,
  CONSTRAINT MACHINE_SPECS_pkey PRIMARY KEY (id)
);
CREATE TABLE public.PAYBACK_PERIOD_CALC2 (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  request_id uuid NOT NULL UNIQUE,
  payback_months numeric,
  CONSTRAINT PAYBACK_PERIOD_CALC2_pkey PRIMARY KEY (id),
  CONSTRAINT calc2_request_refs_calc1_request_fk FOREIGN KEY (request_id) REFERENCES public.MACHINE_SIZE_CALC1(request_id)
);
CREATE TABLE public.REQUEST (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT REQUEST_pkey PRIMARY KEY (id),
  CONSTRAINT request_user_fk FOREIGN KEY (user_id) REFERENCES public.USER(id)
);
CREATE TABLE public.USER (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  name_user character varying NOT NULL,
  email character varying NOT NULL UNIQUE,
  company_number bigint,
  password character varying NOT NULL,
  name_organization character varying,
  position character varying,
  is_admin boolean NOT NULL DEFAULT false,
  confirm character varying,
  CONSTRAINT USER_pkey PRIMARY KEY (id)
);
CREATE TABLE public.WASTE_PROFILE (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  request_id uuid NOT NULL UNIQUE,
  cost_collection_processing numeric NOT NULL CHECK (cost_collection_processing >= 0::numeric),
  hmw_total_weight numeric NOT NULL,
  number_of_barrels_1 integer NOT NULL,
  number_of_barrels_2 integer,
  number_of_barrels_3 integer,
  number_of_barrels_4 integer,
  volume_barrels_1 integer NOT NULL,
  volume_barrels_2 integer,
  volume_barrels_3 integer,
  volume_barrels_4 integer,
  cost_hmw_barrels_1 numeric NOT NULL,
  cost_hmw_barrels_2 numeric,
  cost_hmw_barrels_3 numeric,
  cost_hmw_barrels_4 numeric,
  total_cost_hmw_barrels numeric NOT NULL DEFAULT (((COALESCE(cost_hmw_barrels_1, (0)::numeric) + COALESCE(cost_hmw_barrels_2, (0)::numeric)) + COALESCE(cost_hmw_barrels_3, (0)::numeric)) + COALESCE(cost_hmw_barrels_4, (0)::numeric)),
  steam_generator_needed boolean NOT NULL DEFAULT false,
  wiva_types smallint,
  CONSTRAINT WASTE_PROFILE_pkey PRIMARY KEY (id),
  CONSTRAINT waste_profile_request_id_fkey FOREIGN KEY (request_id) REFERENCES public.REQUEST(id),
  CONSTRAINT waste_profile_request_fk FOREIGN KEY (request_id) REFERENCES public.REQUEST(id)
);
CREATE TABLE public.alembic_version (
  version_num character varying NOT NULL,
  CONSTRAINT alembic_version_pkey PRIMARY KEY (version_num)
);